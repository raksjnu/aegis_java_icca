<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Aegis Report - repo1-mule-api_config (C:\raks\aegis_java_icca\temp\9be94311-8c31-47e1-b1bd-1d34f9f6cb39\repo1-mule-api_config)</title>
    <style>
        :root {
            --raks-purple: #663399;
            --raks-purple-light: #7d4fb2;
            --text-white: #FFFFFF;
        }
        body {font-family: Arial, sans-serif; margin: 0; background-color: #f5f5f5;}
        .report-container { border: 5px solid var(--raks-purple); padding: 20px 40px; margin: 20px; border-radius: 8px; background-color: white; position: relative; }
        h1 {color: var(--raks-purple);}
        .summary {background: #e3f2fd; padding: 20px; border-radius: 8px; margin-bottom: 20px;}
        .search-box { margin-bottom: 20px; width: 100%; }
        #searchInput { width: 100%; padding: 12px; border: 2px solid var(--raks-purple); border-radius: 5px; font-size: 16px; box-sizing: border-box; }
        table {width: 100%; border-collapse: collapse; box-shadow: 0 4px 12px rgba(0,0,0,0.1); table-layout: fixed; }
        th, td {border: 1px solid #ddd; padding: 12px; text-align: left; word-wrap: break-word; overflow-wrap: break-word; }
        th {background-color: var(--raks-purple); color: var(--text-white); cursor: pointer; position: sticky; top: 0; z-index: 10; }
        th:hover { background-color: var(--raks-purple-light); }
        th::after { content: ' ↕'; font-size: 0.8em; }
        .top-nav-container { position: absolute; top: 20px; right: 40px; display: flex; gap: 10px; }
        .top-nav-button {
            background-color: var(--raks-purple); color: var(--text-white);
            border: none; padding: 8px 16px; text-align: center; text-decoration: none;
            display: inline-block; font-size: 14px; font-weight: bold;
            cursor: pointer; border-radius: 5px; transition: background-color 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .top-nav-button:hover { background-color: var(--raks-purple-light); }
    </style>
</head>
<body>
    <div class="report-container">
            <div class="top-nav-container">
            <a href="../CONSOLIDATED-REPORT.html" class="top-nav-button" title="Return to main dashboard">← Dashboard</a>
            <a href="report.xlsx" class="top-nav-button" style="background-color: #217346;">Excel Report</a>
        </div>
        <div style="display: flex; align-items: center; margin-bottom: 20px;">
            <img src="logo.svg" alt="Aegis Logo" style="height: 40px; margin-right: 15px;">
            <h1 style="margin: 0;">Aegis Report</h1>
        </div>
        <div class="summary">
            <strong>Project:</strong> repo1-mule-api_config (C:\raks\aegis_java_icca\temp\9be94311-8c31-47e1-b1bd-1d34f9f6cb39\repo1-mule-api_config)<br>
            <strong>Generated:</strong> 2026-01-20 10:32:23 CST<br>
            <strong>Total Rules:</strong> 8 | <strong style="color:green">PASS:</strong> 6 | <strong style="color:red">FAIL:</strong> 2
        </div>

        <div class="search-box" style="display:flex; gap:10px; align-items:center;">
            <input type="text" id="searchInput" onkeyup="filterTable()" placeholder="Search by name, status, or details..." style="flex-grow:1;">
            <button class="top-nav-button" onclick="toggleAllConfigs(true)" style="width:150px; font-size:12px; white-space:nowrap;">Expand All Configs</button>
            <button class="top-nav-button" onclick="toggleAllConfigs(false)" style="width:120px; font-size:12px; background:#999; white-space:nowrap;">Collapse All</button>
        </div>
        <table id="resultsTable">
            <thead>
                <tr>
                    <th style="width: 5%;" onclick="sortTable(0)">Rule #</th>
                    <th style="width: 25%;" onclick="sortTable(1)">Name</th>
                    <th style="width: 5%;" onclick="sortTable(2)">Severity</th>
                    <th style="width: 5%;" onclick="sortTable(3)">Status</th>
                    <th style="width: 60%;" onclick="sortTable(4)">Details</th>
                </tr>
            </thead>
            <tbody id="tableBody">
                <tr style='background-color:#fff5f5; border-bottom: 4px solid white;'> <td style='border-left: 6px solid #dc3545;'>001</td><td>Enforce Policy Versions</td><td>HIGH</td><td><strong style='color:#721c24'>FAIL</strong></td><td><div style='word-wrap: break-word; white-space: pre-wrap;'>• ✗ Policy version mismatch found (Check report for details)
<strong>Files Checked:</strong> repo_config\Policies\secure.policy
<strong>Items Found:</strong> N/A
<strong>Items Matched:</strong> N/A
<strong>Details:</strong> Property Check failed for VALUE_MATCH. (Mode: ALL_FILES, Passed: 0/1).
• repo_config\Policies\secure.policy [Missing Key: truist.compositeauthn.policy.version, Missing Key: truist.authz.policy.version, Missing Key: noname.policy.version, Missing Key: ratelimit.policy.version, Missing Key: headerinjection.policy.version, Missing Key: headerremoval.policy.version, Missing Key: truist.wssencdec.policy.version, Missing Key: truist.jsonencdec.policy.version]
<strong>Properties Resolved:</strong> N/A</div><div style='margin-top:5px; padding-top:5px; border-top:1px dashed #ccc; font-size:0.85rem; color:#666;'><a href='javascript:void(0)' id='config-BANK-109-9cb38920-link' class='config-toggle' onclick="toggleConfig('config-BANK-109-9cb38920')" style='text-decoration:none; color:#663399; font-weight:bold;'>[+] Show Rule Config</a><div id='config-BANK-109-9cb38920' class='rule-config' style='display:none; margin-top:10px; margin-left:20px; padding:12px; background:#e3f2fd; border:1px solid #90caf9; border-left: 5px solid #2196f3; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius:4px; font-family: Consolas, monospace; white-space: pre-wrap; color: #0d47a1;'>id: BANK-109
name: Enforce Policy Versions
description: Validates all Truist policy versions.
enabled: true
severity: HIGH
successMessage: |-
  ✓ All policy versions are correct
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
errorMessage: |-
  ✗ Policy version mismatch found (Check report for details)
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
checks:
- type: MANDATORY_PROPERTY_VALUE_CHECK
  params:
    filePatterns:
    - '**/Policies/**/*.policy'
    properties:
    - name: truist.compositeauthn.policy.version
      values:
      - 3.0.0
    - name: truist.authz.policy.version
      values:
      - 3.0.0
    - name: noname.policy.version
      values:
      - 5.1.0
    - name: ratelimit.policy.version
      values:
      - 1.4.1
    - name: headerinjection.policy.version
      values:
      - 1.3.2
    - name: headerremoval.policy.version
      values:
      - 1.1.2
    - name: truist.wssencdec.policy.version
      values:
      - 3.0.0
    - name: truist.jsonencdec.policy.version
      values:
      - 3.0.0</div></div></td></tr><tr style='background-color:#fff5f5; border-bottom: 4px solid white;'> <td style='border-left: 6px solid #dc3545;'>002</td><td>Header Injection Policy (WARN mode logging)</td><td>HIGH</td><td><strong style='color:#721c24'>FAIL</strong></td><td><div style='word-wrap: break-word; white-space: pre-wrap;'>• ✗ Header Injection policy values must be 'WARN mode logging'
<strong>Files Checked:</strong> repo_config\Policies\secure.policy
<strong>Items Found:</strong> N/A
<strong>Items Matched:</strong> N/A
<strong>Details:</strong> Property Check failed for VALUE_MATCH. (Mode: ALL_FILES, Passed: 0/1).
• repo_config\Policies\secure.policy [Missing Key: headerinjection.policy.inboundheadermap.x-tfc-request-out, Missing Key: headerinjection.policy.inboundheadermap.x-tfc-response-in]
<strong>Properties Resolved:</strong> N/A</div><div style='margin-top:5px; padding-top:5px; border-top:1px dashed #ccc; font-size:0.85rem; color:#666;'><a href='javascript:void(0)' id='config-Header Injection Policy Validation in Config-447504bb-link' class='config-toggle' onclick="toggleConfig('config-Header Injection Policy Validation in Config-447504bb')" style='text-decoration:none; color:#663399; font-weight:bold;'>[+] Show Rule Config</a><div id='config-Header Injection Policy Validation in Config-447504bb' class='rule-config' style='display:none; margin-top:10px; margin-left:20px; padding:12px; background:#e3f2fd; border:1px solid #90caf9; border-left: 5px solid #2196f3; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius:4px; font-family: Consolas, monospace; white-space: pre-wrap; color: #0d47a1;'>id: Header Injection Policy Validation in Config
name: Header Injection Policy (WARN mode logging)
description: null
enabled: true
severity: HIGH
successMessage: |-
  ✓ Header Injection policy configured correctly (WARN mode logging)
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
errorMessage: |-
  ✗ Header Injection policy values must be 'WARN mode logging'
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
checks:
- type: MANDATORY_PROPERTY_VALUE_CHECK
  params:
    filePatterns:
    - '**/Policies/**/*.policy'
    properties:
    - name: headerinjection.policy.inboundheadermap.x-tfc-request-out
      values:
      - WARN
    - name: headerinjection.policy.inboundheadermap.x-tfc-response-in
      values:
      - WARN</div></div></td></tr><tr style='background-color:#f0fff4; border-bottom: 4px solid white;'> <td style='border-left: 6px solid #28a745;'>003</td><td>Forbid Legacy Auth Policies</td><td>HIGH</td><td><strong style='color:#155724'>PASS</strong></td><td><div style='word-wrap: break-word; white-space: pre-wrap;'>✓ No legacy Auth policies found
<strong>Files Checked:</strong> repo_config\Policies\secure.policy
<strong>Items Found:</strong> N/A
<strong>Items Matched:</strong> secure.policy
<strong>Details:</strong> Passed FORBIDDEN check in 1/1 files (Mode: ALL_FILES)
<strong>Properties Resolved:</strong> N/A</div><div style='margin-top:5px; padding-top:5px; border-top:1px dashed #ccc; font-size:0.85rem; color:#666;'><a href='javascript:void(0)' id='config-BANK-008-00f4f422-link' class='config-toggle' onclick="toggleConfig('config-BANK-008-00f4f422')" style='text-decoration:none; color:#663399; font-weight:bold;'>[+] Show Rule Config</a><div id='config-BANK-008-00f4f422' class='rule-config' style='display:none; margin-top:10px; margin-left:20px; padding:12px; background:#e3f2fd; border:1px solid #90caf9; border-left: 5px solid #2196f3; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius:4px; font-family: Consolas, monospace; white-space: pre-wrap; color: #0d47a1;'>id: BANK-008
name: Forbid Legacy Auth Policies
description: Detects old AAA or Basic Auth policies.
enabled: true
severity: HIGH
successMessage: |-
  ✓ No legacy Auth policies found
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
errorMessage: |-
  ✗ Legacy Auth policy detected (Truist-AAA or TruistBasicAuthnPolicy). Upgrade to CompositeAuth
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
checks:
- type: GENERIC_TOKEN_SEARCH_FORBIDDEN
  params:
    filePatterns:
    - '**/Policies/**/*.policy'
    tokens:
    - Truist-AAA-SOAP
    - Truist-AAA-HTTP
    - TruistBasicAuthnPolicy</div></div></td></tr><tr style='background-color:#f0fff4; border-bottom: 4px solid white;'> <td style='border-left: 6px solid #28a745;'>004</td><td>Forbid DLP Properties</td><td>HIGH</td><td><strong style='color:#155724'>PASS</strong></td><td><div style='word-wrap: break-word; white-space: pre-wrap;'>✓ No DLP properties found
<strong>Files Checked:</strong> repo_config\Properties\OCP\dev.properties, repo_config\Properties\OCP\prod.properties
<strong>Items Found:</strong> N/A
<strong>Items Matched:</strong> dev.properties, prod.properties
<strong>Details:</strong> Passed FORBIDDEN check in 2/2 files (Mode: ALL_FILES)
<strong>Properties Resolved:</strong> N/A</div><div style='margin-top:5px; padding-top:5px; border-top:1px dashed #ccc; font-size:0.85rem; color:#666;'><a href='javascript:void(0)' id='config-BANK-020-9f95b324-link' class='config-toggle' onclick="toggleConfig('config-BANK-020-9f95b324')" style='text-decoration:none; color:#663399; font-weight:bold;'>[+] Show Rule Config</a><div id='config-BANK-020-9f95b324' class='rule-config' style='display:none; margin-top:10px; margin-left:20px; padding:12px; background:#e3f2fd; border:1px solid #90caf9; border-left: 5px solid #2196f3; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius:4px; font-family: Consolas, monospace; white-space: pre-wrap; color: #0d47a1;'>id: BANK-020
name: Forbid DLP Properties
description: null
enabled: true
severity: HIGH
successMessage: |-
  ✓ No DLP properties found
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
errorMessage: |-
  ✗ DLP property detected (dlp.flag or dlp.requestqueue)
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
checks:
- type: GENERIC_TOKEN_SEARCH_FORBIDDEN
  params:
    wholeWord: true
    filePatterns:
    - '**/*.properties'
    tokens:
    - north.bound.dlp.flag
    - south.bound.dlp.flag
    - wmq.dlp.requestqueue
    ignoreComments: true</div></div></td></tr><tr style='background-color:#f0fff4; border-bottom: 4px solid white;'> <td style='border-left: 6px solid #28a745;'>005</td><td>Enforce SQL Server DB connection String Security</td><td>HIGH</td><td><strong style='color:#155724'>PASS</strong></td><td><div style='word-wrap: break-word; white-space: pre-wrap;'>⊘ Skipped: Preconditions not met for this project.</div><div style='margin-top:5px; padding-top:5px; border-top:1px dashed #ccc; font-size:0.85rem; color:#666;'><a href='javascript:void(0)' id='config-BANK-021-b87d19e8-link' class='config-toggle' onclick="toggleConfig('config-BANK-021-b87d19e8')" style='text-decoration:none; color:#663399; font-weight:bold;'>[+] Show Rule Config</a><div id='config-BANK-021-b87d19e8' class='rule-config' style='display:none; margin-top:10px; margin-left:20px; padding:12px; background:#e3f2fd; border:1px solid #90caf9; border-left: 5px solid #2196f3; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius:4px; font-family: Consolas, monospace; white-space: pre-wrap; color: #0d47a1;'>id: BANK-021
name: Enforce SQL Server DB connection String Security
description: null
enabled: true
severity: HIGH
successMessage: |-
  ✓ SQL Server DB Connection Strings are securely configured (or none found)
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
errorMessage: |-
  ✗ SQL Server DB Connection String missing ';encrypt=false;trustServerCertificate=false'
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
checks:
- type: CONDITIONAL_CHECK
  params:
    preconditions:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns:
        - '**/*.properties'
        tokens:
        - jdbc:sqlserver
        matchMode: ANY_FILE
    onSuccess:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns:
        - '**/*.properties'
        tokens:
        - jdbc:sqlserver(?!.*encrypt=false).*
        - jdbc:sqlserver(?!.*trustServerCertificate=false).*
        matchMode: REGEX
        isRegex: true
        ignoreComments: true
        failureMessage: Found SQL Server DB Connection String (missing 'encrypt=false' and/or 'trustServerCertificate=false')</div></div></td></tr><tr style='background-color:#f0fff4; border-bottom: 4px solid white;'> <td style='border-left: 6px solid #28a745;'>006</td><td>Enforce DB2 Connection URL contains ApplicationId</td><td>MEDIUM</td><td><strong style='color:#155724'>PASS</strong></td><td><div style='word-wrap: break-word; white-space: pre-wrap;'>⊘ Skipped: Preconditions not met for this project.</div><div style='margin-top:5px; padding-top:5px; border-top:1px dashed #ccc; font-size:0.85rem; color:#666;'><a href='javascript:void(0)' id='config-DB2 AppId-c4720975-link' class='config-toggle' onclick="toggleConfig('config-DB2 AppId-c4720975')" style='text-decoration:none; color:#663399; font-weight:bold;'>[+] Show Rule Config</a><div id='config-DB2 AppId-c4720975' class='rule-config' style='display:none; margin-top:10px; margin-left:20px; padding:12px; background:#e3f2fd; border:1px solid #90caf9; border-left: 5px solid #2196f3; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius:4px; font-family: Consolas, monospace; white-space: pre-wrap; color: #0d47a1;'>id: DB2 AppId
name: Enforce DB2 Connection URL contains ApplicationId
description: null
enabled: true
severity: MEDIUM
successMessage: |-
  ✓ DB2 Connection URL ApplicationId is present
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
errorMessage: |-
  ✗ DB2 Connection URL ApplicationId is missing
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
checks:
- type: CONDITIONAL_CHECK
  params:
    preconditions:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns:
        - '**/*.properties'
        tokens:
        - jdbc:db2
        wholeWord: false
    onSuccess:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns:
        - '**/*.properties'
        tokens:
        - jdbc:db2(?!.*(?i)ApplicationId=).*
        matchMode: REGEX
        isRegex: true
        failureMessage: Found DB2 Connection URL missing 'ApplicationId'</div></div></td></tr><tr style='background-color:#f0fff4; border-bottom: 4px solid white;'> <td style='border-left: 6px solid #28a745;'>007</td><td>Forbid Legacy DB2 VIPs</td><td>HIGH</td><td><strong style='color:#155724'>PASS</strong></td><td><div style='word-wrap: break-word; white-space: pre-wrap;'>✓ No legacy DB2 VIPs found
<strong>Files Checked:</strong> repo_config\Properties\OCP\dev.properties, repo_config\Properties\OCP\prod.properties
<strong>Items Found:</strong> N/A
<strong>Items Matched:</strong> dev.properties, prod.properties
<strong>Details:</strong> Passed FORBIDDEN check in 2/2 files (Mode: ALL_FILES)
<strong>Properties Resolved:</strong> N/A</div><div style='margin-top:5px; padding-top:5px; border-top:1px dashed #ccc; font-size:0.85rem; color:#666;'><a href='javascript:void(0)' id='config-Legacy DB2 VIPs-6807676b-link' class='config-toggle' onclick="toggleConfig('config-Legacy DB2 VIPs-6807676b')" style='text-decoration:none; color:#663399; font-weight:bold;'>[+] Show Rule Config</a><div id='config-Legacy DB2 VIPs-6807676b' class='rule-config' style='display:none; margin-top:10px; margin-left:20px; padding:12px; background:#e3f2fd; border:1px solid #90caf9; border-left: 5px solid #2196f3; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius:4px; font-family: Consolas, monospace; white-space: pre-wrap; color: #0d47a1;'>id: Legacy DB2 VIPs
name: Forbid Legacy DB2 VIPs
description: null
enabled: true
severity: HIGH
successMessage: |-
  ✓ No legacy DB2 VIPs found
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
errorMessage: |-
  ✗ Legacy DB2 VIP connection detected. Migrate to DVIPA (dsndb0e/h)
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
checks:
- type: GENERIC_TOKEN_SEARCH_FORBIDDEN
  params:
    filePatterns:
    - '**/*.properties'
    tokens:
    - db2contppvip.truist-tst.com:50000
    - db2contstvip.truist-tst.com:50000
    - wil-db2contstvip.bbtnet.com:50000</div></div></td></tr><tr style='background-color:#f0fff4; border-bottom: 4px solid white;'> <td style='border-left: 6px solid #28a745;'>008</td><td>Validate MQ Cipher Suite in Config</td><td>HIGH</td><td><strong style='color:#155724'>PASS</strong></td><td><div style='word-wrap: break-word; white-space: pre-wrap;'>✓ MQ Cipher Suite is correct (or not defined)
<strong>Files Checked:</strong> repo_config\Properties\OCP\dev.properties, repo_config\Properties\OCP\prod.properties
<strong>Items Found:</strong> N/A
<strong>Items Matched:</strong> dev.properties, prod.properties
<strong>Details:</strong> Passed FORBIDDEN check in 2/2 files (Mode: REGEX)
<strong>Properties Resolved:</strong> N/A</div><div style='margin-top:5px; padding-top:5px; border-top:1px dashed #ccc; font-size:0.85rem; color:#666;'><a href='javascript:void(0)' id='config-MQ Cipher Suite Validation in Config-e7b493f7-link' class='config-toggle' onclick="toggleConfig('config-MQ Cipher Suite Validation in Config-e7b493f7')" style='text-decoration:none; color:#663399; font-weight:bold;'>[+] Show Rule Config</a><div id='config-MQ Cipher Suite Validation in Config-e7b493f7' class='rule-config' style='display:none; margin-top:10px; margin-left:20px; padding:12px; background:#e3f2fd; border:1px solid #90caf9; border-left: 5px solid #2196f3; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius:4px; font-family: Consolas, monospace; white-space: pre-wrap; color: #0d47a1;'>id: MQ Cipher Suite Validation in Config
name: Validate MQ Cipher Suite in Config
description: Ensures ibm.mq.cipherSuite uses the secure value IF it is defined.
enabled: true
severity: HIGH
successMessage: |-
  ✓ MQ Cipher Suite is correct (or not defined)
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
errorMessage: |-
  ✗ MQ Cipher Suite is incorrect. Must be TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
  Files Checked: {CHECKED_FILES}
  Items Found: {FOUND_ITEMS}
  Items Matched: {MATCHING_FILES}
  Details: {DEFAULT_MESSAGE}
  {PROPERTY_RESOLVED}
checks:
- type: GENERIC_TOKEN_SEARCH_FORBIDDEN
  params:
    filePatterns:
    - '**/*.properties'
    tokens:
    - ibm\.mq\.cipherSuite\s*=(?!\s*TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384).*
    matchMode: REGEX
    isRegex: true</div></div></td></tr>
            </tbody>
        </table>
    </div>
    <script>
        function toggleConfig(id) {
            var x = document.getElementById(id);
            var link = document.getElementById(id + '-link');
            if (x.style.display === "none") {
                x.style.display = "block";
                if(link) link.innerHTML = "[-] Hide Rule Config";
            } else {
                x.style.display = "none";
                if(link) link.innerHTML = "[+] Show Rule Config";
            }
        }

        function toggleAllConfigs(expand) {
            var configs = document.getElementsByClassName("rule-config");
            for (var i = 0; i < configs.length; i++) {
                var div = configs[i];
                var id = div.id;
                var link = document.getElementById(id + '-link');
                if (expand) {
                    div.style.display = "block";
                    if (link) link.innerHTML = "[-] Hide Rule Config";
                } else {
                    div.style.display = "none";
                    if (link) link.innerHTML = "[+] Show Rule Config";
                }
            }
        }

        function filterTable() {
            var input, filter, table, tr, td, i, txtValue;
            input = document.getElementById("searchInput");
            filter = input.value.toUpperCase();
            table = document.getElementById("resultsTable");
            tr = table.getElementsByTagName("tr");

            // Remove existing highlights first
            removeHighlights();

            for (i = 1; i < tr.length; i++) {
                var found = false;
                var tds = tr[i].getElementsByTagName("td");
                for (var j = 0; j < tds.length; j++) {
                    if (tds[j]) {
                        txtValue = tds[j].textContent || tds[j].innerText;
                        if (txtValue.toUpperCase().indexOf(filter) > -1) {
                            found = true;
                            break;
                        }
                    }
                }
                tr[i].style.display = found ? "" : "none";
            }

            // Apply highlighting if there is a filter
            if (filter.length > 0) {
                highlightSearch(input.value);
            }
        }

        function removeHighlights() {
            var highlighted = document.querySelectorAll('span.search-highlight');
            highlighted.forEach(function(span) {
                var parent = span.parentNode;
                parent.replaceChild(document.createTextNode(span.textContent), span);
                parent.normalize();
            });
        }

        function highlightSearch(term) {
            if (!term) return;
            // Escape regex special characters in the term
            // We use a simplified character set to avoid Java escaping hell
            // [-.[]{}()...] -> escaped with double backslash for Java string literal
            var escapedTerm = term.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, '\\$&');
            var regex;
            try {
                regex = new RegExp("(" + escapedTerm + ")", "gi");
            } catch (e) {
                return;
            }
            var body = document.getElementById("tableBody");
            recursiveHighlight(body, regex);
        }

        function recursiveHighlight(node, regex) {
            if (node.nodeType === 3) { // Text node
                 if (node.nodeValue.trim().length > 0 && regex.test(node.nodeValue)) {
                     var span = document.createElement("span");
                     span.innerHTML = node.nodeValue.replace(regex, "<span class='search-highlight' style='background-color: #ffeb3b; color: black; font-weight: bold; padding: 2px 4px; border-radius: 2px;'>$1</span>");
                     node.parentNode.replaceChild(span, node);
                 }
            } else if (node.nodeType === 1 && node.nodeName !== "SCRIPT" && node.nodeName !== "STYLE" && !node.classList.contains("search-highlight")) {
                 // Clone children to avoid iteration issues if we modify DOM
                 var children = Array.from(node.childNodes);
                 for (var i = 0; i < children.length; i++) {
                     recursiveHighlight(children[i], regex);
                 }
            }
        }

        function sortTable(n) {
            var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
            table = document.getElementById("resultsTable");
            switching = true;
            dir = "asc";
            while (switching) {
                switching = false;
                rows = table.rows;
                for (i = 1; i < (rows.length - 1); i++) {
                    shouldSwitch = false;
                    x = rows[i].getElementsByTagName("TD")[n];
                    y = rows[i + 1].getElementsByTagName("TD")[n];
                    if (dir == "asc") {
                        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                            shouldSwitch = true;
                            break;
                        }
                    } else if (dir == "desc") {
                        if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                            shouldSwitch = true;
                            break;
                        }
                    }
                }
                if (shouldSwitch) {
                    rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                    switching = true;
                    switchcount++;
                } else {
                    if (switchcount == 0 && dir == "asc") {
                        dir = "desc";
                        switching = true;
                    }
                }
            }
        }
    </script>
</body>
</html>
